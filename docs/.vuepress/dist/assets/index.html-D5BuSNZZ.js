import{_ as o,c as l,b as s,a as i,d as t,e as a,w as p,r as c,o as r}from"./app-32apV4Rh.js";const d={};function u(k,n){const e=c("RouteLink");return r(),l("div",null,[n[9]||(n[9]=s("h1",{id:"配置指南",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#配置指南"},[s("span",null,"配置指南")])],-1)),n[10]||(n[10]=s("p",null,"Croupier C++ SDK 支持灵活的配置系统，包括文件配置、环境变量覆盖和配置验证。",-1)),n[11]||(n[11]=s("h2",{id:"目录",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#目录"},[s("span",null,"目录")])],-1)),s("ul",null,[s("li",null,[t(e,{to:"/configuration/client-config.html"},{default:p(()=>[...n[0]||(n[0]=[a("客户端配置",-1)])]),_:1}),n[1]||(n[1]=a(" - ClientConfig 完整参考",-1))]),s("li",null,[t(e,{to:"/configuration/environments.html"},{default:p(()=>[...n[2]||(n[2]=[a("环境配置",-1)])]),_:1}),n[3]||(n[3]=a(" - 多环境配置管理",-1))]),s("li",null,[t(e,{to:"/configuration/security.html"},{default:p(()=>[...n[4]||(n[4]=[a("安全配置",-1)])]),_:1}),n[5]||(n[5]=a(" - TLS 和认证配置",-1))])]),n[12]||(n[12]=i(`<h2 id="快速开始" tabindex="-1"><a class="header-anchor" href="#快速开始"><span>快速开始</span></a></h2><h3 id="基础配置文件" tabindex="-1"><a class="header-anchor" href="#基础配置文件"><span>基础配置文件</span></a></h3><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;game_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo-game&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;env&quot;</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;service_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo-service&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;agent_addr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1:19090&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;insecure&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="加载配置" tabindex="-1"><a class="header-anchor" href="#加载配置"><span>加载配置</span></a></h3><div class="language-cpp line-numbers-mode" data-highlighter="prismjs" data-ext="cpp"><pre><code class="language-cpp"><span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;croupier/sdk/config/client_config_loader.h&quot;</span></span></span>
<span class="line"></span>
<span class="line">ClientConfigLoader loader<span class="token punctuation">;</span></span>
<span class="line">ClientConfig config <span class="token operator">=</span> loader<span class="token punctuation">.</span><span class="token function">LoadFromFile</span><span class="token punctuation">(</span><span class="token string">&quot;./config.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="环境变量覆盖" tabindex="-1"><a class="header-anchor" href="#环境变量覆盖"><span>环境变量覆盖</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">CROUPIER_GAME_ID</span><span class="token operator">=</span>production-game</span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">CROUPIER_ENV</span><span class="token operator">=</span>production</span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">CROUPIER_AGENT_ADDR</span><span class="token operator">=</span>croupier-agent:19090</span>
<span class="line"></span>
<span class="line">./your-app</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置加载器" tabindex="-1"><a class="header-anchor" href="#配置加载器"><span>配置加载器</span></a></h2><h3 id="clientconfigloader-方法" tabindex="-1"><a class="header-anchor" href="#clientconfigloader-方法"><span>ClientConfigLoader 方法</span></a></h3><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td><code>LoadFromFile(path)</code></td><td>从 JSON 文件加载</td></tr><tr><td><code>LoadFromJson(json)</code></td><td>从 JSON 字符串加载</td></tr><tr><td><code>LoadWithEnvironmentOverrides(path, prefix)</code></td><td>加载并应用环境变量</td></tr><tr><td><code>LoadProfile(dir, profile)</code></td><td>加载配置 profile</td></tr><tr><td><code>ValidateConfig(config)</code></td><td>验证配置</td></tr></tbody></table><h3 id="示例" tabindex="-1"><a class="header-anchor" href="#示例"><span>示例</span></a></h3><div class="language-cpp line-numbers-mode" data-highlighter="prismjs" data-ext="cpp"><pre><code class="language-cpp"><span class="line">ClientConfigLoader loader<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 文件加载</span></span>
<span class="line">ClientConfig config <span class="token operator">=</span> loader<span class="token punctuation">.</span><span class="token function">LoadFromFile</span><span class="token punctuation">(</span><span class="token string">&quot;./production.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 环境变量覆盖</span></span>
<span class="line">ClientConfig config <span class="token operator">=</span> loader<span class="token punctuation">.</span><span class="token function">LoadWithEnvironmentOverrides</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token string">&quot;./production.json&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;CROUPIER_&quot;</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 验证</span></span>
<span class="line"><span class="token keyword">auto</span> errors <span class="token operator">=</span> loader<span class="token punctuation">.</span><span class="token function">ValidateConfig</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>errors<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> error <span class="token operator">:</span> errors<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        std<span class="token double-colon punctuation">::</span>cerr <span class="token operator">&lt;&lt;</span> error <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="环境变量" tabindex="-1"><a class="header-anchor" href="#环境变量"><span>环境变量</span></a></h2><p>所有配置字段都可以通过环境变量覆盖，使用 <code>CROUPIER_</code> 前缀：</p><table><thead><tr><th>配置字段</th><th>环境变量</th></tr></thead><tbody><tr><td><code>game_id</code></td><td><code>CROUPIER_GAME_ID</code></td></tr><tr><td><code>env</code></td><td><code>CROUPIER_ENV</code></td></tr><tr><td><code>agent_addr</code></td><td><code>CROUPIER_AGENT_ADDR</code></td></tr><tr><td><code>service_id</code></td><td><code>CROUPIER_SERVICE_ID</code></td></tr><tr><td><code>insecure</code></td><td><code>CROUPIER_INSECURE</code></td></tr><tr><td><code>timeout_seconds</code></td><td><code>CROUPIER_TIMEOUT_SECONDS</code></td></tr><tr><td><code>auto_reconnect</code></td><td><code>CROUPIER_AUTO_RECONNECT</code></td></tr><tr><td><code>reconnect_interval_seconds</code></td><td><code>CROUPIER_RECONNECT_INTERVAL_SECONDS</code></td></tr></tbody></table><h3 id="嵌套字段" tabindex="-1"><a class="header-anchor" href="#嵌套字段"><span>嵌套字段</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 安全配置</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">CROUPIER_CERT_FILE</span><span class="token operator">=</span><span class="token string">&quot;/path/to/cert.pem&quot;</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">CROUPIER_KEY_FILE</span><span class="token operator">=</span><span class="token string">&quot;/path/to/key.pem&quot;</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">CROUPIER_CA_FILE</span><span class="token operator">=</span><span class="token string">&quot;/path/to/ca.pem&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 认证配置</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">CROUPIER_AUTH_TOKEN</span><span class="token operator">=</span><span class="token string">&quot;Bearer token123&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置文件位置" tabindex="-1"><a class="header-anchor" href="#配置文件位置"><span>配置文件位置</span></a></h2><p>SDK 按以下顺序查找配置文件：</p><ol><li>当前目录：<code>./config.json</code></li><li>用户目录：<code>~/.croupier/config.json</code></li><li>系统目录：<code>/etc/croupier/config.json</code></li></ol><p>可以通过命令行或代码指定：</p><div class="language-cpp line-numbers-mode" data-highlighter="prismjs" data-ext="cpp"><pre><code class="language-cpp"><span class="line"><span class="token comment">// 指定配置文件</span></span>
<span class="line">ClientConfig config <span class="token operator">=</span> loader<span class="token punctuation">.</span><span class="token function">LoadFromFile</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/config.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置验证" tabindex="-1"><a class="header-anchor" href="#配置验证"><span>配置验证</span></a></h2><p>配置加载器会自动验证：</p><ul><li>✅ 必需字段存在</li><li>✅ 网络地址格式正确</li><li>✅ 文件路径存在</li><li>✅ 环境名称有效</li><li>✅ 数值范围合理</li></ul><h3 id="自定义验证" tabindex="-1"><a class="header-anchor" href="#自定义验证"><span>自定义验证</span></a></h3><div class="language-cpp line-numbers-mode" data-highlighter="prismjs" data-ext="cpp"><pre><code class="language-cpp"><span class="line"><span class="token keyword">class</span> <span class="token class-name">CustomValidator</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token keyword">public</span><span class="token operator">:</span></span>
<span class="line">    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token operator">&gt;</span> <span class="token function">Validate</span><span class="token punctuation">(</span><span class="token keyword">const</span> ClientConfig<span class="token operator">&amp;</span> config<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token operator">&gt;</span> errors<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>game_id<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            errors<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">&quot;game_id 不能为空&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>env <span class="token operator">!=</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>env <span class="token operator">!=</span> <span class="token string">&quot;staging&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            errors<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">&quot;env 必须是 production 或 staging&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>timeout_seconds <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> config<span class="token punctuation">.</span>timeout_seconds <span class="token operator">&gt;</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            errors<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">&quot;timeout_seconds 必须在 1-300 之间&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> errors<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="下一步" tabindex="-1"><a class="header-anchor" href="#下一步"><span>下一步</span></a></h2>`,28)),s("ul",null,[s("li",null,[t(e,{to:"/configuration/client-config.html"},{default:p(()=>[...n[6]||(n[6]=[a("客户端配置详解",-1)])]),_:1})]),s("li",null,[t(e,{to:"/configuration/environments.html"},{default:p(()=>[...n[7]||(n[7]=[a("多环境配置",-1)])]),_:1})]),s("li",null,[t(e,{to:"/configuration/security.html"},{default:p(()=>[...n[8]||(n[8]=[a("安全配置",-1)])]),_:1})])])])}const v=o(d,[["render",u]]),b=JSON.parse('{"path":"/configuration/","title":"配置指南","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1767578349000,"contributors":[{"name":"cuihairu","username":"cuihairu","email":"chuihairu@gmail.com","commits":1,"url":"https://github.com/cuihairu"}],"changelog":[{"hash":"9f779e5a68d857bd3783f75205b7139940ee5a76","time":1767578349000,"email":"chuihairu@gmail.com","author":"cuihairu","message":"docs: add VuePress documentation and GitHub Pages deployment"}]},"filePathRelative":"configuration/README.md"}');export{v as comp,b as data};
